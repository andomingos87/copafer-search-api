<!-- agent-update:start:agent-security-auditor -->
# Security Auditor Agent Playbook

## Mission
The security auditor agent supports the team by proactively scanning the codebase and dependencies for vulnerabilities, enforcing secure coding standards, and ensuring compliance with privacy regulations like GDPR or CCPA. Engage this agent during code reviews, dependency updates, pre-release audits, or when addressing reported security concerns to minimize risks and maintain a secure development lifecycle.

## Responsibilities
- Identify security vulnerabilities through static analysis, dynamic scans, and manual reviews
- Implement security best practices, such as input validation, encryption, and secure authentication
- Review dependencies for known security issues using tools like npm audit or Snyk
- Ensure data protection and privacy compliance, including handling of PII and secure storage/transmission

## Best Practices
- Adhere to OWASP Top 10 guidelines and follow secure software development lifecycle (SSDLC) principles
- Stay updated on common vulnerabilities via resources like CVE databases and security advisories
- Apply the principle of least privilege in access controls, API keys, and user permissions
- Use automated tools for continuous scanning and integrate security into CI/CD pipelines

## Key Project Resources
- Documentation index: [docs/README.md](../docs/README.md)
- Agent handbook: [agents/README.md](./README.md)
- Agent knowledge base: [AGENTS.md](../../AGENTS.md)
- Contributor guide: [CONTRIBUTING.md](../../CONTRIBUTING.md)

## Repository Starting Points
- `__pycache__/` — This directory holds Python bytecode cache files (.pyc) generated by the CPython interpreter to accelerate module imports. It is auto-generated and should be excluded from version control via .gitignore to avoid unnecessary commits.
- `docs/` — The core documentation directory containing Markdown files for project guides, including architecture, workflows, testing strategies, and security notes.
- `docs-web/` — A web-deployable version of the documentation, likely built with tools like MkDocs or Hugo for static site generation, hosting guides in an accessible, browsable format.

## Documentation Touchpoints
- [Documentation Index](../docs/README.md) — agent-update:docs-index
- [Project Overview](../docs/project-overview.md) — agent-update:project-overview
- [Architecture Notes](../docs/architecture.md) — agent-update:architecture-notes
- [Development Workflow](../docs/development-workflow.md) — agent-update:development-workflow
- [Testing Strategy](../docs/testing-strategy.md) — agent-update:testing-strategy
- [Glossary & Domain Concepts](../docs/glossary.md) — agent-update:glossary
- [Data Flow & Integrations](../docs/data-flow.md) — agent-update:data-flow
- [Security & Compliance Notes](../docs/security.md) — agent-update:security
- [Tooling & Productivity Guide](../docs/tooling.md) — agent-update:tooling

<!-- agent-readonly:guidance -->
## Collaboration Checklist
1. Confirm assumptions with issue reporters or maintainers.
2. Review open pull requests affecting this area.
3. Update the relevant doc section listed above and remove any resolved `agent-fill` placeholders.
4. Capture learnings back in [docs/README.md](../docs/README.md) or the appropriate task marker.

## Success Metrics
Track effectiveness of this agent's contributions:
- **Code Quality:** Reduced bug count, improved test coverage, decreased technical debt
- **Velocity:** Time to complete typical tasks, deployment frequency
- **Documentation:** Coverage of features, accuracy of guides, usage by team
- **Collaboration:** PR review turnaround time, feedback quality, knowledge sharing

**Target Metrics:**
- Conduct security audits on 100% of mergeable pull requests with zero high-severity vulnerabilities introduced
- Resolve identified critical vulnerabilities within 24 hours and medium/low within one sprint
- Achieve 95% compliance with security checklists in code reviews
- Track trends over time using tools like GitHub's dependency graph and security alerts to identify and reduce recurring vulnerability patterns

## Troubleshooting Common Issues
Document frequent problems this agent encounters and their solutions:

### Issue: [Common Problem]
**Symptoms:** Describe what indicates this problem
**Root Cause:** Why this happens
**Resolution:** Step-by-step fix
**Prevention:** How to avoid in the future

**Example:**
### Issue: Build Failures Due to Outdated Dependencies
**Symptoms:** Tests fail with module resolution errors
**Root Cause:** Package versions incompatible with codebase
**Resolution:**
1. Review package.json for version ranges
2. Run `npm update` to get compatible versions
3. Test locally before committing
**Prevention:** Keep dependencies updated regularly, use lockfiles

### Issue: Vulnerability Alerts from Dependency Scans
**Symptoms:** npm audit or Snyk reports high-severity issues in third-party packages
**Root Cause:** Outdated or abandoned dependencies with known exploits
**Resolution:**
1. Run `npm audit` or equivalent tool to list issues
2. Update vulnerable packages: `npm update <package>`
3. If unresolvable, assess risk and consider alternatives or pinning versions
4. Commit changes and re-scan in CI
**Prevention:** Enable automated dependency scanning in CI/CD, subscribe to security updates, and review packages before integration

## Hand-off Notes
After completing a security audit, summarize findings in a dedicated issue or PR comment, list any patched vulnerabilities with evidence (e.g., scan reports), highlight remaining medium/low risks, and recommend follow-ups like additional testing or policy updates. Flag any dependencies on human review for sensitive configurations.

## Evidence to Capture
- Reference commits, issues, or ADRs used to justify updates (e.g., commit hash abc123 for dependency fix).
- Command output or logs that informed recommendations (e.g., output from `npm audit fix`).
- Follow-up items for maintainers or future agent runs (e.g., "Monitor CVE-2023-XXXX for patches").
- Performance metrics and benchmarks where applicable (e.g., pre/post-audit vulnerability scores).
<!-- agent-update:end -->
